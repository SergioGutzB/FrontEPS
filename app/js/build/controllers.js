function pacienteAddController(e,t,n,o,i,a){var l=this;l.sData=n,t.pageTitle="Registrar Paciente",t.pageIcon="fa-user-plus";var s=function(e){e&&(e.$setPristine(),e.$setUntouched()),l.patient={type:"patient",email:"",password:"",password_confirmation:"",document:"",name:"",last_name:"",gender:"",birthdate:"",phone:"",aditional_information:{blood_type:"",civil_status:"",occupation:"",live_with:"",religion:"",companion:"",place_of_birth:"",municipality:"",city:"",address:"",cellphone:"",ethnicity:"",education_level:"",state:""}}};s(),null!==l.sData.patient&&(console.log(l.sData.patient.id),o.getUser(l.sData.patient.id).then(function(e){console.log(e.data),l.patient=e.data},function(e){l.patient=l.sData.patient}),l.title="Editar Paciente",l.icon="fa-user");var r=function(){i.show(i.simple().textContent("Paciente registrado!").position("top right").hideDelay(3e3))},c=function(e){a.show(a.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Error de registro").textContent("No ha sido posible registrar el paciente, intente nuevamente.").ariaLabel("Error registro de paciente").ok("Volver").targetEvent(e))};l.save=function(e){var t={type:l.patient.type,email:l.patient.email,password:l.patient.document,password_confirmation:l.patient.document,document:l.patient.document,name:l.patient.name,last_name:l.patient.last_name,gender:l.patient.gender,birthdate:l.patient.birthdate,phone:l.patient.phone,blood_type:l.patient.additional_information_user.blood_type,civil_status:l.patient.additional_information_user.civil_status,occupation:l.patient.additional_information_user.occupation,live_with:l.patient.additional_information_user.live_with,religion:l.patient.additional_information_user.religion,companion:l.patient.additional_information_user.companion,place_of_birth:l.patient.additional_information_user.place_of_birth,state:l.patient.additional_information_user.state,municipality:l.patient.additional_information_user.municipality,city:l.patient.additional_information_user.city,address:l.patient.additional_information_user.address,cellphone:l.patient.additional_information_user.cellphone,ethnicity:l.patient.additional_information_user.ethnicity,education_level:l.patient.additional_information_user.education_level};if(l.patient.attendants){({document:l.patient.attendants.document,name:l.patient.attendants.name,last_name:l.patient.attendants.last_name,address:l.patient.attendants.address,relationship:l.patient.attendants.relationship,phone:l.patient.attendants.phone,user:l.patientdocument})}o.addPatient(t).then(function(t){"ok"==t.data.status&&(r(),s(e))},function(e){c($event)})}}function profesionalAddController(e,t,n,o,i,a,l){var s=this;s.sData=n,t.pageTitle="Registrar Profesional",t.pageIcon="fa-user-md",s.dias=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],s.searchTerm="",s.clearSearchTerm=function(){s.searchTerm=""},s.especialidades={},o.getServices().then(function(e){s.especialidades=e.data.services});var r=function(){i.show(i.simple().textContent("Profesional registrado!").position("top right").hideDelay(6e3))},c=function(e){a.show(a.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Error de registro").textContent("No ha sido posible registrar el Profesional, intente nuevamente.").ariaLabel("Error registro de Profesional").ok("Volver").targetEvent(e))},d=function(e){e&&(e.$setPristine(),e.$setUntouched()),s.profesional={}};d(),null!==s.sData.profesional&&(s.profesional=s.sData.profesional,s.profesional.fechaNacimiento=new Date(Date.parse(s.profesional.fechaNacimiento)),s.profesional.consultorio=parseInt(s.profesional.consultorio),s.title="Editar Profesional",s.icon="fa-user"),s.save=function(e){var t={birthdate:s.profesional.birthdate,gender:s.profesional.gender,last_name:s.profesional.last_name,name:s.profesional.name,phone:s.profesional.phone,email:s.profesional.email,password:s.profesional.document,password_confirmation:s.profesional.document,document:s.profesional.document,type:"doctor",speciality:s.profesional.speciality,medical_license:s.profesional.medical_license,schedule:s.profesional.startsAt+" - "+s.profesional.endsAt,worked_days:s.profesional.worked_days};o.addProfesional(t).then(function(t){r(),d(e),l.path("/profesionales")},function(e){console.log(e),c($event)})}}function adminController(e,t,n,o,i,a,l,s,r){function c(){i.getServices().then(function(e){console.log(e.data),g.gridEspOptions.data=e.data.services,console.log(g.gridEspOptions.data)})}function d(){i.getUsers().then(function(e){console.log(e.data),g.gridUserOptions.data=e.data.users.filter(function(e){return"Functionary"===e.type}),console.log(g.gridUserOptions.data)})}function p(e){r.show(r.simple().textContent(e).position("top right").hideDelay(6e3))}function u(e,t,n){var o=this;o.eps={name:"",fieldsFV:["motivo","farmacologicos","enFamiliares","enPersonales","enPsiquiatricas","medicamentos","demograficos","hallasgos","evPsicologica","impresionDiagnostica","condutaSeguir","pruebas","diagnostico"],fieldsFE:["objetivo","sesion","evolucion","condutaSeguir","diagnostico"],fieldsNPOS:["procedimientos"]},o.sData=t,o.hide=function(){e.hide()},o.cancel=function(){e.cancel()},o.answer=function(t){e.hide(t)},o.addEspecialidad=function(){console.log(o.eps),n.addServices(o.eps).then(function(e){console.log(e),c(),o.hide(),p("Especialidad Registrada!")})}}function f(e,t,n,o){var i=this;i.sData=t,i.hide=function(){e.hide()},i.cancel=function(){e.cancel()},i.answer=function(t){e.hide(t)},i.funcionario=null,i.save=function(){if(i.funcionario){var e=i.funcionario;$.extend(e,{type:"functionary"}),console.log(e),n.addProfesional(e).then(function(e){i.hide(),d(),p("Funcionario Registrado!")})}}}var g=this;g.sData=n,t.currenPage="admin",t.pageTitle="Administración",t.pageIcon="fa-cog",g.gridUserOptions={enableRowSelection:!0,enableRowHeaderSelection:!1,enableFiltering:!1,multiSelect:!1,modifierKeysToMultiSelect:!1,noUnselect:!0,onRegisterApi:function(e){g.gridUserApi=e},columnDefs:[{field:"id"},{field:"document"}]},g.toggleRowSelection=function(){g.sData.patient=null,g.gridUserApi.selection.clearSelectedRows(),g.gridUserOptions.enableRowSelection=!g.gridUserOptions.enableRowSelection,g.gridUserApi.core.notifyDataChange(l.dataChange.OPTIONS)},d(),a(function(){g.gridUserApi.selection.selectRow(g.gridUserOptions.data[0]),g.gridUserApi.selection.clearSelectedRows()},0,1),g.gridEspOptions={enableRowSelection:!0,enableRowHeaderSelection:!1,enableFiltering:!1,multiSelect:!1,modifierKeysToMultiSelect:!1,noUnselect:!0,onRegisterApi:function(e){g.gridEspApi=e},columnDefs:[{field:"id"},{field:"name"}]},g.toggleRowSelection=function(){g.sData.patient=null,g.gridEspApi.selection.clearSelectedRows(),g.gridEspOptions.enableRowSelection=!g.gridEspOptions.enableRowSelection,g.gridEspApi.core.notifyDataChange(l.dataChange.OPTIONS)},c(),a(function(){g.gridEspApi.selection.selectRow(g.gridEspOptions.data[0]),g.gridEspApi.selection.clearSelectedRows()},0,1),g.showModalEspecialidad=function(e){s.show({controller:u,controllerAs:"dEsp",bindToController:!0,templateUrl:"/views/modalEspecialidad.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:g.customFullscreen}).then(function(e){g.status='You said the information was "'+e+'".'},function(){g.status="You cancelled the dialog."})},u.$inject=["$mdDialog","sData","eps"],g.showModalFuncionario=function(e){s.show({controller:f,controllerAs:"dFun",bindToController:!0,templateUrl:"/views/modalFuncionario.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!1,fullscreen:g.customFullscreen}).then(function(e){g.status='You said the information was "'+e+'".'},function(){g.status="You cancelled the dialog."})},f.$inject=["$mdDialog","sData","eps","$mdToast"]}function CitasController(e,t,n,o,i,a,l,s,r,c,d){var p=this;p.sData=c,p.cita={},o.currentPage="citas_medicas",o.pageTitle="Citas Médicas",o.pageIcon="fa-calendar";var u=function(){d.getCites().then(function(e){console.log("citas..."),console.log(e.data.cites),console.log(p.patient.id),p.cites=e.data.cites.filter(function(e){return e.patient.id===p.patient.id}),p.cites=p.cites.map(function(e){var t,o;return e.valuation&&(t="Valoración",o=a.colorTypes.warning),$.extend(e,{title:t,color:o,startsAt:n(e.date_cite).format(),endsAt:n(e.end_cite).format()})}),console.log(p.cites)},function(e){console.log(e),p.cites={}})};null!==p.sData.patient&&(p.patient=p.sData.patient,u()),l.$watch(function(){return p.cita.speciality},function(){d.getProfesionales().then(function(e){p.profesionals=e.data.doctors.filter(function(e){return e.speciality===p.cita.speciality})})}),p.openToast=function(t){e.show(e.simple().textContent("Hello!"))},p.calendarView="week",p.viewDate=new Date,p.rangeSelected=function(e,t){p.firstDateClicked=e,p.lastDateClicked=t},a.dateFormatter="moment";var f=angular.copy(a.i18nStrings);a.i18nStrings.weekNumber="Semana {week}",s.moment=s.moment||n,r.load("../../../bower_components/moment/locale/es.js").then(function(){n.locale("es",{week:{dow:1}}),n.locale("es")}),l.$on("$destroy",function(){n.locale("en"),a.i18nStrings=f});p.cellIsOpen=!0,p.add=function(){console.log("Añdiendo cita..."),p.cita.date_cite=n(p.cita.date_cite).format("YYYY-MM-DD HH:mm"),p.cita.end_cite=n(p.cita.end_cite).format("YYYY-MM-DD HH:mm"),p.cita=$.extend(p.cita,{patient_id:p.patient.id,authorized:!1,available:!0}),console.log(p.cita),d.addCite(p.cita).then(function(e){u(),p.openToast("Cita médica guardada con éxito"),p.cita={}},function(e){})},l.$watch(function(){return p.cita.date_cite},function(){var e=n(p.cita.end_cite).format("YYYY-MM-DD HH:mm");e=p.cita.valuation?n(e).add(20,"m"):n(e).add(30,"m"),p.cita.end_cite=e}),p.eventClicked=function(e){i.show("Clicked",e)},p.eventEdited=function(e){i.show("Edited",e)},p.eventDeleted=function(e){console.log("Deleted"),i.show("Deleted ju",e)},p.eventTimesChanged=function(e){i.show("Dropped or resized",e)},p.toggle=function(e,t,n){e.preventDefault(),e.stopPropagation(),n[t]=!n[t]},p.timespanClicked=function(e,t){"month"===p.calendarView?p.cellIsOpen&&n(e).startOf("day").isSame(n(p.viewDate).startOf("day"))||0===t.events.length||!t.inMonth?p.cellIsOpen=!1:(p.cellIsOpen=!0,p.viewDate=e):"year"===p.calendarView&&(p.cellIsOpen&&n(e).startOf("month").isSame(n(p.viewDate).startOf("month"))||0===t.events.length?p.cellIsOpen=!1:(p.cellIsOpen=!0,p.viewDate=e))}}function DashBoardController(e,t,n){e.currentPage="inicio",e.pageTitle="Inicio",e.pageIcon="fa-home"}function hcController(e,t,n,o,i){var a=this;a.sData=n,t.pageTitle="Historia Clínica",t.pageIcon="fa-address-card",null!==a.sData.patient&&i.getUser(a.sData.patient.id).then(function(e){a.patient=e.data,console.log("paciente: ",a.patient)},function(e){a.patient=a.sData.patient}),a.addHc=function(){console.log("añadiendo hc"),a.hc=$.extend(a.hc,{user:a.sData.patient.id}),a.hc.valuation_format=JSON.stringify(a.hc.valuation_format),a.hc.evolution_format=JSON.stringify(a.hc.evolution_format),a.hc.format_not_pos=JSON.stringify(a.hc.format_not_pos),a.hc.valuation_format||(a.hc.valuation_format="{}"),a.hc.evolution_format||(a.hc.evolution_format="{}"),a.hc.format_not_pos||(a.hc.format_not_pos="{}"),console.log(a.hc),i.addHc(a.hc).then(function(e){console.log(e)},function(e){console.log(e)})},i.getHc(n.patient.id).then(function(e){a.hcs=e.data.histories,console.log(a.hcs)},function(e){console.log(e)}),null===a.sData.paciente&&o.path("/pacientes"),a.paciente=a.sData.paciente}function indexController(e,t,n){var o=this;o.close=function(){console.log("close")},e.pageTitle="Inicio",e.pageIcon="fa-home",e.currentPage=t.path().split("/")[1],o.go=function(n){e.currentPage=n,t.path("/"+n),""===n&&(e.currentPage="inicio")}}function loginController(e,t,n,o,i,a){var l=this;l.admin={email:"admin2@gmail.com",password:"1234567",password_confirmation:"1234567",document:"1234567",type:"admin",name:"Administrador",last_name:"Administrador",nickname:"1234567"},n.validateUser().then(function(){console.log("redirecionando.."),t.path("/")}).catch(function(e){console.log("no validate user..")}),l.submitLogin=function(){n.submitLogin(l.loginForm).then(function(n){console.log("logeado");var i=n.id;a.getUser(i).then(function(n){var i=n.data;e.user=i,e.sesion=i.type,null===i.type&&(t.path("/citas_medicas"),o.ROL_CURRENT_USER=3),"Functionary"===i.type&&(t.path("/citas_medicas"),o.ROL_CURRENT_USER=4),"Patient"===i.type&&(t.path("/citas_medicas"),o.ROL_CURRENT_USER=2),"Admin"===i.type&&(t.path("/"),o.ROL_CURRENT_USER=1)}).catch(function(e){})}).catch(function(e){console.log("No logeado")})},e.pageTitle="Login",e.pageIcon="",e.currentPage=t.path().split("/")[1]}function pacientesController(e,t,n,o,i,a,l,s){function r(e,t){var n=this;n.sData=t,n.hide=function(){e.hide()},n.cancel=function(){e.cancel()},n.answer=function(t){e.hide(t)}}var c=this;c.sData=l,t.pageTitle="Pacientes",t.pageIcon="fa-users",c.showAdvanced=function(e){c.getCurrentSelection()&&a.show({controller:r,controllerAs:"dialog",bindToController:!0,templateUrl:"/views/modalPaciente.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:c.customFullscreen}).then(function(e){c.status='You said the information was "'+e+'".'},function(){c.status="You cancelled the dialog."})},c.seleccionable=!0,c.gridOptions={enableRowSelection:!1,enableRowHeaderSelection:!1,paginationPageSizes:[25,50,75],paginationPageSize:25,enablePaginationControls:!1,enableFiltering:!1,multiSelect:!1,modifierKeysToMultiSelect:!1,noUnselect:!0,onRegisterApi:function(e){c.gridApi=e,c.gridApi.grid.registerRowsProcessor(c.singleFilter,200)},columnDefs:[{field:"id"},{field:"name"},{field:"last_name"},{field:"document"},{field:"birthdate"},{field:"phone"}]},c.toggleRowSelection=function(){c.sData.patient=null,c.gridApi.selection.clearSelectedRows(),c.gridOptions.enableRowSelection=!c.gridOptions.enableRowSelection,c.gridApi.core.notifyDataChange(o.dataChange.OPTIONS)},c.getCurrentSelection=function(){return c.sData.patient=c.gridApi.selection.getSelectedRows()[0],console.log("selecionado"),console.log(c.sData.patient),void 0!==c.sData.patient},c.filter=function(){c.gridApi.grid.refresh()},c.singleFilter=function(e){var t=new RegExp(c.filterValue);return e.forEach(function(e){var n=!1;["document","name","last_name"].forEach(function(o){e.entity[o].match(t)&&(n=!0)}),n||(e.visible=!1)}),e},e.$watch(function(){return c.filterValue},c.filter),e.$watch(function(){return c.seleccionable},c.toggleRowSelection),c.go=function(e){c.getCurrentSelection()&&i.path("/"+e)},c.goAdd=function(e){c.sData.patient=null,i.path("/addPaciente")},s.getUser(2).then(function(e){console.log("usuario id:"),console.log(e)}),s.getUsers().then(function(e){c.gridOptions.data=e.data.users.filter(function(e){return"Patient"===e.type}),console.log(c.gridOptions.data)}),n(function(){c.gridApi.selection.selectRow(c.gridOptions.data[0]),c.gridApi.selection.clearSelectedRows()},0,1),r.$inject=["$mdDialog","sData"]}function profesionalesController(e,t,n,o,i,a,l,s){var r=this;r.sData=l,r.seleccionable=!0,r.filterValue="",t.pageTitle="Pacientes",t.pageIcon="fa-user-md",r.gridOptions={enableRowSelection:!1,enableRowHeaderSelection:!1,paginationPageSizes:[25,50,75],paginationPageSize:25,enablePaginationControls:!1,enableFiltering:!1,multiSelect:!1,modifierKeysToMultiSelect:!1,noUnselect:!0,onRegisterApi:function(e){r.gridApi=e,r.gridApi.grid.registerRowsProcessor(r.singleFilter,200)},columnDefs:[{field:"name"},{field:"last_name"},{field:"document"},{field:"birthdate"},{field:"speciality"},{field:"consultorio"}]},r.toggleRowSelection=function(){r.sData.profesional=null,r.gridApi.selection.clearSelectedRows(),r.gridOptions.enableRowSelection=!r.gridOptions.enableRowSelection,r.gridApi.core.notifyDataChange(o.dataChange.OPTIONS)},r.getCurrentSelection=function(){return r.sData.profesional=r.gridApi.selection.getSelectedRows()[0],void 0!==r.sData.profesional},r.filter=function(){r.filterValue&&r.gridApi.grid.refresh()},r.singleFilter=function(e){var t=new RegExp(r.filterValue);return e.forEach(function(e){var n=!1;["name","last_name","document","speciality"].forEach(function(o){e.entity[o].match(t)&&(n=!0)}),n||(e.visible=!1)}),e},e.$watch(function(){return r.filterValue},r.filter),e.$watch(function(){return r.seleccionable},r.toggleRowSelection),r.go=function(e){r.getCurrentSelection()&&i.path("/"+e)},r.goAdd=function(e){r.sData.profesional=null,i.path("/addProfesional")},s.getProfesionales().then(function(e){console.log(e)},function(e){console.log("error.."),console.log(e)}),s.getProfesional(1).then(function(e){console.log(e)},function(e){console.log(e)}),r.gridOptions.data=r.sData.profesionales,n(function(){r.gridApi.selection.selectRow(r.gridOptions.data[0]),r.gridApi.selection.clearSelectedRows()},0,1)}var eps=angular.module("Eps");eps.controller("PacienteAdd",pacienteAddController),pacienteAddController.$inject=["$scope","$rootScope","sData","eps","$mdToast","$mdDialog"];var eps=angular.module("Eps");eps.controller("ProfesionalAdd",profesionalAddController),profesionalAddController.$inject=["$scope","$rootScope","sData","eps","$mdToast","$mdDialog","$location"];var eps=angular.module("Eps");eps.controller("Admin",adminController),adminController.$inject=["$scope","$rootScope","sData","$location","eps","$interval","uiGridConstants","$mdDialog","$mdToast"];var eps=angular.module("Eps");eps.controller("Citas",CitasController),CitasController.$inject=["$mdToast","$auth","moment","$rootScope","alert","calendarConfig","$scope","$window","$ocLazyLoad","sData","eps"];var eps=angular.module("Eps");eps.controller("DashBoard",DashBoardController),DashBoardController.$inject=["$rootScope","$location","$auth"];var eps=angular.module("Eps");eps.controller("HC",hcController),hcController.$inject=["$scope","$rootScope","sData","$location","eps"];var eps=angular.module("Eps");eps.controller("Index",indexController),indexController.$inject=["$rootScope","$location","$auth"];var eps=angular.module("Eps");eps.controller("Login",loginController),loginController.$inject=["$rootScope","$location","$auth","CONFIG","ROLES","eps"];var eps=angular.module("Eps");eps.controller("Pacientes",pacientesController),pacientesController.$inject=["$scope","$rootScope","$interval","uiGridConstants","$location","$mdDialog","sData","eps"];var eps=angular.module("Eps");eps.controller("Profesionales",profesionalesController),profesionalesController.$inject=["$scope","$rootScope","$interval","uiGridConstants","$location","$mdDialog","sData","eps"];